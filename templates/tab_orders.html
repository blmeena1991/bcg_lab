{% extends "base_orders.html" %}
{% load paginator filters %}

{% block menu_order %}active{% endblock %}

{% block header %}
  <h1>Gestion des commandes</h1>
  <h2>Commandes en cours</h2>
{% endblock %}

{% block content %}
{% if orders.object_list %}
  <table class="list">
    <thead>
      <th>Date</th>
      <th>Fournisseur</th>
      {% if user|has_multiple_teams %}
        <th>Equipe</th>
      {% endif %}
      {% if user|is_validator or user|is_super_validator %}
        <th>Budget</th>
      {% endif %}
      <th>Montant</th>
      <th>Statut</th>
      <th>Cmde N°</th>
      <th>Dernière MAJ</th>
      <th>Action</th>
    </thead>
    
    <tbody>
      {% for order in orders.object_list %}
        <tr class="{% cycle 'even' 'odd' %}">
          <td>{{ order.date_created|date }}</td>
          <td>{{ order.provider.name }}</td>
          {% if user|has_multiple_teams %}
            <td>{{ order.get_full_name }}</td>
          {% endif %}
          {% if user|is_validator or user|is_super_validator %}
            <td>{{ order.budget.name }}</td>
          {% endif %}
          <td>{{ order.price }} €</td>
          <td><b>{{ order.get_status_display }}</b></td>
          <td>{{ order.number|default:"" }}</td>
          <td>{{ order.last_change|date }}</td>
          <td>
            <a href="{{ order.get_absolute_url }}?next=tab_orders" class="pencil">Voir détail</a>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
  
  {% pagination orders %}
  <div class="cleaner"></div>
{% else %}
  <p>Aucune commande en cours.</p>
{% endif %}
{% endblock %}
